"use strict";function haversine_distance(e,o){var t=e.lat*(Math.PI/180),a=o.lat*(Math.PI/180),s=a-t,e=(o.lng-e.lng)*(Math.PI/180);return 7917.6*Math.asin(Math.sqrt(Math.sin(s/2)*Math.sin(s/2)+Math.cos(t)*Math.cos(a)*Math.sin(e/2)*Math.sin(e/2)))}window.whereToBuy={isGeolocationActive:!1,endpoint:"https://1cf1-2804-14d-4cdc-8789-5c26-b7f7-ffdb-bb30.ngrok.io",map:void 0,autocomplete:void 0,physicalStoresList:void 0,onlineStoresList:void 0,init:function(){window.whereToBuy.address.init(),window.whereToBuy.maps.init(),window.whereToBuy.physicalStoresList=document.querySelector(".where-to-buy__map-physical-stores"),window.whereToBuy.onlineStoresList=document.querySelector(".where-to-buy__map-online-stores")},loadResults:function(e){var o=window.whereToBuy,e={coordinates:e,country:"ca",limit:4};fetch("".concat(o.endpoint,"/coords"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){o.maps.storeMarkers&&o.maps.storeMarkers.map(function(e){return e.setMap(null)}),o.maps.storeMarkers=[],console.log(e),e&&e.body&&e.body.length?e.body.map(function(e){o.physicalStoresList.innerHTML="";e={lat:e.location.coordinates[1],lng:e.location.coordinates[0]},e=o.maps.setMarker(e,"store");o.maps.storeMarkers.push(e)}):console.error("no data returned")}).catch(function(e){return console.error(e)})},address:{autocomplete:void 0,init:function(){var e=window.whereToBuy;e.address.autocomplete=new google.maps.places.Autocomplete(document.getElementById("where-to-buy__autocomplete"),{componentRestrictions:{country:"ca"},fields:["geometry","name"],strictBounds:!1,types:[]}),e.address.autocomplete.addListener("place_changed",e.address.onPlaceChanged)},onPlaceChanged:function(){var e=window.whereToBuy,o=e.address.autocomplete.getPlace();o.geometry?(o={lat:o.geometry.location.lat(),lng:o.geometry.location.lng()},e.maps.map.setCenter(o),e.maps.setMarker(o),e.maps.show(),e.loadResults(o)):console.warn("User did not select a prediction")}},maps:{isMapsActive:!1,locationButton:void 0,map:void 0,userMarker:void 0,storeMarkers:void 0,init:function(){var e=document.getElementById("where-to-buy__map");window.whereToBuy.maps.locationButton=document.getElementById("where-to-buy__location-button"),window.whereToBuy.maps.map=new google.maps.Map(e,{zoom:12,center:{lat:49.28323201694063,lng:-123.12089349382718},styles:window.whereToBuy.maps.styles,disableDefaultUI:!0,zoomControl:!0,controlSize:30})},show:function(){document.querySelector(".where-to-buy__autocomplete-cta").classList.add("hide"),document.querySelector(".where-to-buy__map-container").classList.add("where-to-buy__map-container--active"),window.whereToBuy.maps.isMapsActive=!0},setMarker:function(e){var o=window.whereToBuy;if("user"!==(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"user"))return new google.maps.Marker({position:e,map:window.whereToBuy.maps.map,icon:window.whereToBuyAssets.storeMarker});o.maps.userMarker?o.maps.userMarker.setPosition(e):o.maps.userMarker=new google.maps.Marker({position:e,map:window.whereToBuy.maps.map,icon:window.whereToBuyAssets.userMarker})},onToggleLocation:function(){var e=window.whereToBuy;e.isGeolocationActive?(e.isGeolocationActive=!1,e.maps.locationButton.classList.remove("where-to-buy__location-button--active")):e.maps.activateLocation()},activateLocation:function(){var o=window.whereToBuy;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){o.maps.show();e={lat:e.coords.latitude,lng:e.coords.longitude};o.loadResults(e),o.maps.map.setCenter(e),o.isGeolocationActive=!0,o.maps.locationButton.classList.add("where-to-buy__location-button--active"),o.maps.setMarker(e)},function(){o.isGeolocationActive=!1,console.error("Use of geolocation not allowed")}):console.warn("Navigator doesn't have geolocation")},styles:[{featureType:"landscape",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{stylers:[{hue:"#00aaff"},{saturation:-100},{gamma:2.15},{lightness:12}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{visibility:"on"},{lightness:24}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:57}]}]}};